<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comlink</title>
</head>

<body>

    <h1>Comlink example</h1>
    
    <output id="comlink"></output>

    <script type="module">
        import * as Comlink from "https://unpkg.com/comlink/dist/esm/comlink.mjs";

        const w = new Worker("worker_comlink.js");
        const comlink_worker = Comlink.wrap(w);

        document.onmousemove = (e) => {
            comlink_worker.handleMousePosition({ clientX: e.clientX, clientY: e.clientY }, Comlink.proxy(callbackPosition))
        }

        document.onclick = (e) => {
            comlink_worker.handleMouseClick({ clientX: e.clientX, clientY: e.clientY }, Comlink.proxy(callbackClick))
        }

        function callbackPosition(data) {
            document.getElementById("comlink").innerHTML = 'Position: ' + data.payload.clientX + 'x' + data.payload.clientY
        }
        
        function callbackClick(data) {
            document.getElementById("comlink").innerHTML = '<strong>Click: ' + data.payload.clientX + 'x' + data.payload.clientY + '</strong>'
        }

    </script>

    <p>
        <a href="./index.html">WebWorker example</a>
    </p>
</body>

</html>